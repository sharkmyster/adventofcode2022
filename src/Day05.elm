module Day05 exposing (..)

import List.Extra as LX
import Set


initStack : List (List Char)
initStack =
    [ [ 'D', 'H', 'R', 'Z', 'S', 'P', 'W', 'Q' ]
    , [ 'F', 'H', 'Q', 'W', 'R', 'B', 'V' ]
    , [ 'H', 'S', 'V', 'C' ]
    , [ 'G', 'F', 'H' ]
    , [ 'Z', 'B', 'J', 'G', 'P' ]
    , [ 'L', 'F', 'W', 'H', 'J', 'T', 'Q' ]
    , [ 'N', 'J', 'V', 'L', 'D', 'W', 'T', 'Z' ]
    , [ 'F', 'H', 'G', 'J', 'C', 'Z', 'T', 'D' ]
    , [ 'H', 'B', 'M', 'V', 'P', 'W' ]
    ]


doMove : ( Int, Int, Int ) -> List (List Char) -> List (List Char)
doMove ( numBoxes, from, to ) stack =
    let
        source =
            Maybe.withDefault [] (LX.getAt (from - 1) stack)

        (top, bottom) =
             LX.splitAt numBoxes source

        rev =
            top |> List.reverse
    in
    stack
        |> LX.updateAt (from - 1) (\_ -> bottom )
        |> LX.updateAt (to - 1) (\l -> List.append top l)

pull res =
    case res of
        Just n -> n
        Nothing -> ' '

part1 =
    List.foldl (\ m s -> doMove m s) initStack rawData
    |> List.map List.head
    |> List.map pull
    |> String.fromList


rawData =
    [ ( 1, 3, 9 )
    , ( 2, 2, 1 )
    , ( 3, 5, 4 )
    , ( 1, 1, 8 )
    , ( 1, 3, 9 )
    , ( 1, 5, 7 )
    , ( 1, 5, 3 )
    , ( 4, 4, 2 )
    , ( 2, 3, 4 )
    , ( 1, 3, 2 )
    , ( 6, 1, 5 )
    , ( 1, 4, 3 )
    , ( 1, 3, 9 )
    , ( 4, 2, 4 )
    , ( 4, 8, 7 )
    , ( 3, 2, 6 )
    , ( 1, 2, 7 )
    , ( 5, 5, 6 )
    , ( 1, 5, 8 )
    , ( 5, 8, 7 )
    , ( 7, 4, 6 )
    , ( 15, 6, 4 )
    , ( 1, 8, 7 )
    , ( 1, 1, 5 )
    , ( 1, 2, 4 )
    , ( 2, 4, 8 )
    , ( 1, 5, 2 )
    , ( 5, 6, 4 )
    , ( 2, 2, 1 )
    , ( 1, 9, 4 )
    , ( 1, 6, 9 )
    , ( 3, 9, 3 )
    , ( 3, 4, 3 )
    , ( 1, 6, 1 )
    , ( 5, 3, 4 )
    , ( 2, 8, 5 )
    , ( 1, 3, 6 )
    , ( 1, 6, 2 )
    , ( 1, 2, 8 )
    , ( 6, 4, 2 )
    , ( 1, 2, 7 )
    , ( 1, 5, 3 )
    , ( 4, 9, 3 )
    , ( 1, 9, 1 )
    , ( 3, 1, 6 )
    , ( 1, 9, 7 )
    , ( 14, 7, 6 )
    , ( 1, 8, 3 )
    , ( 4, 2, 6 )
    , ( 3, 3, 8 )
    , ( 9, 4, 9 )
    , ( 1, 1, 5 )
    , ( 2, 5, 8 )
    , ( 3, 8, 2 )
    , ( 4, 2, 6 )
    , ( 1, 3, 9 )
    , ( 10, 6, 1 )
    , ( 5, 9, 8 )
    , ( 1, 9, 3 )
    , ( 6, 1, 8 )
    , ( 3, 7, 4 )
    , ( 2, 4, 5 )
    , ( 2, 9, 8 )
    , ( 15, 8, 3 )
    , ( 3, 7, 9 )
    , ( 8, 4, 3 )
    , ( 2, 5, 9 )
    , ( 6, 6, 5 )
    , ( 6, 5, 8 )
    , ( 1, 7, 8 )
    , ( 6, 9, 2 )
    , ( 5, 2, 4 )
    , ( 6, 3, 5 )
    , ( 5, 5, 8 )
    , ( 1, 5, 7 )
    , ( 1, 9, 7 )
    , ( 2, 6, 4 )
    , ( 12, 8, 2 )
    , ( 7, 2, 4 )
    , ( 3, 7, 5 )
    , ( 3, 5, 7 )
    , ( 3, 7, 9 )
    , ( 2, 9, 7 )
    , ( 1, 9, 3 )
    , ( 2, 7, 4 )
    , ( 3, 1, 9 )
    , ( 4, 6, 5 )
    , ( 6, 2, 8 )
    , ( 14, 4, 9 )
    , ( 7, 9, 6 )
    , ( 9, 9, 2 )
    , ( 1, 5, 8 )
    , ( 5, 6, 3 )
    , ( 3, 1, 9 )
    , ( 3, 8, 9 )
    , ( 1, 8, 3 )
    , ( 5, 2, 5 )
    , ( 1, 4, 9 )
    , ( 2, 6, 1 )
    , ( 2, 3, 6 )
    , ( 3, 8, 3 )
    , ( 2, 6, 3 )
    , ( 1, 4, 9 )
    , ( 4, 3, 6 )
    , ( 7, 6, 9 )
    , ( 10, 9, 2 )
    , ( 10, 3, 2 )
    , ( 7, 2, 8 )
    , ( 2, 1, 7 )
    , ( 13, 3, 7 )
    , ( 7, 5, 1 )
    , ( 1, 9, 6 )
    , ( 4, 8, 4 )
    , ( 2, 3, 2 )
    , ( 4, 4, 6 )
    , ( 1, 3, 4 )
    , ( 5, 6, 5 )
    , ( 3, 5, 7 )
    , ( 12, 2, 5 )
    , ( 7, 5, 6 )
    , ( 2, 8, 3 )
    , ( 7, 6, 2 )
    , ( 3, 9, 6 )
    , ( 1, 6, 7 )
    , ( 1, 4, 9 )
    , ( 2, 7, 6 )
    , ( 13, 7, 4 )
    , ( 3, 7, 5 )
    , ( 1, 9, 6 )
    , ( 12, 4, 3 )
    , ( 1, 8, 1 )
    , ( 2, 6, 4 )
    , ( 1, 7, 9 )
    , ( 2, 9, 8 )
    , ( 12, 3, 5 )
    , ( 1, 8, 2 )
    , ( 15, 5, 6 )
    , ( 2, 4, 6 )
    , ( 1, 9, 6 )
    , ( 5, 5, 4 )
    , ( 4, 4, 2 )
    , ( 2, 1, 5 )
    , ( 4, 1, 5 )
    , ( 1, 8, 6 )
    , ( 7, 5, 2 )
    , ( 22, 2, 3 )
    , ( 9, 6, 3 )
    , ( 1, 1, 8 )
    , ( 1, 8, 7 )
    , ( 23, 3, 6 )
    , ( 2, 2, 4 )
    , ( 1, 7, 8 )
    , ( 1, 8, 2 )
    , ( 19, 6, 9 )
    , ( 2, 2, 4 )
    , ( 4, 4, 6 )
    , ( 13, 6, 8 )
    , ( 12, 9, 1 )
    , ( 2, 5, 9 )
    , ( 2, 4, 8 )
    , ( 1, 2, 7 )
    , ( 1, 7, 1 )
    , ( 4, 6, 2 )
    , ( 10, 1, 9 )
    , ( 1, 6, 7 )
    , ( 11, 8, 2 )
    , ( 6, 3, 6 )
    , ( 1, 7, 2 )
    , ( 1, 1, 8 )
    , ( 2, 6, 7 )
    , ( 7, 6, 3 )
    , ( 9, 3, 1 )
    , ( 7, 9, 6 )
    , ( 1, 8, 7 )
    , ( 4, 2, 6 )
    , ( 1, 8, 3 )
    , ( 6, 6, 5 )
    , ( 9, 9, 3 )
    , ( 5, 6, 1 )
    , ( 1, 7, 8 )
    , ( 2, 8, 4 )
    , ( 1, 4, 2 )
    , ( 1, 4, 5 )
    , ( 2, 5, 6 )
    , ( 1, 6, 9 )
    , ( 9, 1, 4 )
    , ( 4, 4, 6 )
    , ( 2, 4, 7 )
    , ( 7, 2, 8 )
    , ( 5, 6, 7 )
    , ( 6, 3, 8 )
    , ( 8, 1, 9 )
    , ( 3, 5, 2 )
    , ( 2, 3, 9 )
    , ( 3, 9, 4 )
    , ( 7, 2, 3 )
    , ( 1, 7, 2 )
    , ( 10, 3, 2 )
    , ( 6, 9, 4 )
    , ( 1, 3, 1 )
    , ( 1, 1, 8 )
    , ( 4, 8, 5 )
    , ( 10, 8, 4 )
    , ( 2, 8, 9 )
    , ( 7, 4, 9 )
    , ( 6, 2, 6 )
    , ( 3, 6, 5 )
    , ( 4, 4, 9 )
    , ( 8, 7, 5 )
    , ( 1, 9, 2 )
    , ( 7, 2, 1 )
    , ( 4, 9, 8 )
    , ( 2, 6, 3 )
    , ( 2, 3, 2 )
    , ( 13, 5, 7 )
    , ( 5, 4, 9 )
    , ( 5, 1, 7 )
    , ( 3, 5, 8 )
    , ( 17, 7, 2 )
    , ( 15, 2, 6 )
    , ( 15, 9, 5 )
    , ( 1, 9, 5 )
    , ( 4, 8, 6 )
    , ( 1, 4, 6 )
    , ( 5, 4, 7 )
    , ( 5, 2, 7 )
    , ( 18, 6, 2 )
    , ( 2, 7, 6 )
    , ( 10, 2, 8 )
    , ( 2, 2, 3 )
    , ( 11, 8, 7 )
    , ( 7, 7, 5 )
    , ( 9, 7, 5 )
    , ( 3, 7, 5 )
    , ( 2, 1, 7 )
    , ( 4, 2, 1 )
    , ( 30, 5, 1 )
    , ( 1, 3, 1 )
    , ( 35, 1, 9 )
    , ( 2, 2, 5 )
    , ( 2, 8, 3 )
    , ( 20, 9, 2 )
    , ( 3, 7, 9 )
    , ( 1, 3, 6 )
    , ( 5, 5, 3 )
    , ( 18, 2, 5 )
    , ( 4, 5, 8 )
    , ( 7, 9, 7 )
    , ( 1, 6, 2 )
    , ( 3, 8, 5 )
    , ( 6, 3, 5 )
    , ( 3, 7, 4 )
    , ( 2, 2, 3 )
    , ( 1, 4, 5 )
    , ( 2, 4, 5 )
    , ( 4, 7, 2 )
    , ( 26, 5, 6 )
    , ( 2, 2, 7 )
    , ( 1, 2, 9 )
    , ( 1, 7, 8 )
    , ( 1, 5, 3 )
    , ( 2, 8, 3 )
    , ( 11, 9, 3 )
    , ( 6, 3, 4 )
    , ( 27, 6, 4 )
    , ( 33, 4, 3 )
    , ( 4, 6, 8 )
    , ( 1, 2, 8 )
    , ( 1, 7, 3 )
    , ( 4, 8, 9 )
    , ( 1, 8, 6 )
    , ( 34, 3, 8 )
    , ( 1, 8, 5 )
    , ( 1, 2, 9 )
    , ( 8, 3, 9 )
    , ( 3, 5, 4 )
    , ( 1, 6, 5 )
    , ( 27, 8, 9 )
    , ( 1, 3, 4 )
    , ( 1, 5, 7 )
    , ( 3, 8, 1 )
    , ( 11, 9, 1 )
    , ( 1, 7, 5 )
    , ( 11, 9, 3 )
    , ( 1, 5, 1 )
    , ( 1, 8, 7 )
    , ( 2, 9, 2 )
    , ( 1, 2, 1 )
    , ( 1, 2, 7 )
    , ( 2, 8, 2 )
    , ( 6, 3, 8 )
    , ( 1, 4, 2 )
    , ( 7, 1, 2 )
    , ( 1, 7, 1 )
    , ( 19, 9, 1 )
    , ( 3, 2, 9 )
    , ( 10, 1, 4 )
    , ( 2, 9, 1 )
    , ( 1, 7, 9 )
    , ( 7, 1, 6 )
    , ( 10, 4, 3 )
    , ( 14, 1, 7 )
    , ( 2, 9, 1 )
    , ( 3, 4, 6 )
    , ( 9, 7, 6 )
    , ( 1, 3, 5 )
    , ( 4, 8, 5 )
    , ( 10, 6, 8 )
    , ( 3, 5, 6 )
    , ( 10, 3, 4 )
    , ( 4, 3, 7 )
    , ( 1, 5, 9 )
    , ( 2, 7, 9 )
    , ( 1, 1, 9 )
    , ( 6, 2, 4 )
    , ( 1, 5, 3 )
    , ( 11, 4, 9 )
    , ( 3, 4, 9 )
    , ( 1, 2, 7 )
    , ( 2, 3, 5 )
    , ( 1, 3, 2 )
    , ( 7, 7, 2 )
    , ( 2, 5, 8 )
    , ( 8, 2, 1 )
    , ( 2, 6, 8 )
    , ( 9, 6, 8 )
    , ( 3, 8, 2 )
    , ( 3, 2, 6 )
    , ( 9, 9, 5 )
    , ( 3, 5, 8 )
    , ( 5, 9, 4 )
    , ( 3, 6, 4 )
    , ( 1, 6, 3 )
    , ( 3, 1, 6 )
    , ( 3, 6, 9 )
    , ( 17, 8, 5 )
    , ( 12, 5, 4 )
    , ( 21, 4, 3 )
    , ( 1, 4, 9 )
    , ( 7, 5, 4 )
    , ( 22, 3, 7 )
    , ( 3, 1, 8 )
    , ( 3, 9, 1 )
    , ( 4, 4, 6 )
    , ( 1, 6, 2 )
    , ( 3, 4, 1 )
    , ( 1, 6, 7 )
    , ( 4, 9, 3 )
    , ( 2, 5, 7 )
    , ( 1, 9, 6 )
    , ( 2, 6, 9 )
    , ( 8, 7, 9 )
    , ( 1, 6, 2 )
    , ( 1, 9, 3 )
    , ( 4, 3, 4 )
    , ( 14, 7, 4 )
    , ( 1, 3, 2 )
    , ( 3, 7, 8 )
    , ( 12, 8, 9 )
    , ( 8, 4, 1 )
    , ( 1, 7, 4 )
    , ( 2, 5, 1 )
    , ( 3, 2, 9 )
    , ( 17, 9, 3 )
    , ( 6, 9, 1 )
    , ( 1, 9, 2 )
    , ( 13, 3, 9 )
    , ( 4, 3, 1 )
    , ( 3, 9, 1 )
    , ( 22, 1, 9 )
    , ( 1, 8, 1 )
    , ( 6, 9, 5 )
    , ( 4, 1, 9 )
    , ( 3, 1, 9 )
    , ( 4, 4, 8 )
    , ( 4, 4, 2 )
    , ( 1, 4, 3 )
    , ( 3, 8, 9 )
    , ( 1, 3, 4 )
    , ( 1, 1, 3 )
    , ( 1, 8, 2 )
    , ( 1, 5, 8 )
    , ( 4, 2, 1 )
    , ( 1, 8, 7 )
    , ( 10, 9, 6 )
    , ( 1, 7, 9 )
    , ( 1, 2, 3 )
    , ( 1, 6, 1 )
    , ( 3, 5, 7 )
    , ( 1, 8, 7 )
    , ( 1, 6, 1 )
    , ( 1, 2, 4 )
    , ( 1, 5, 2 )
    , ( 19, 9, 2 )
    , ( 1, 4, 7 )
    , ( 1, 3, 7 )
    , ( 3, 7, 9 )
    , ( 4, 1, 2 )
    , ( 10, 9, 4 )
    , ( 1, 5, 8 )
    , ( 3, 6, 4 )
    , ( 1, 3, 4 )
    , ( 10, 2, 8 )
    , ( 12, 2, 5 )
    , ( 3, 5, 9 )
    , ( 5, 6, 5 )
    , ( 5, 1, 4 )
    , ( 22, 4, 3 )
    , ( 3, 8, 7 )
    , ( 1, 7, 2 )
    , ( 3, 2, 9 )
    , ( 19, 3, 5 )
    , ( 2, 7, 8 )
    , ( 7, 5, 6 )
    , ( 5, 9, 6 )
    , ( 1, 9, 3 )
    , ( 16, 5, 1 )
    , ( 2, 3, 1 )
    , ( 3, 7, 3 )
    , ( 7, 8, 4 )
    , ( 2, 8, 1 )
    , ( 5, 5, 9 )
    , ( 1, 5, 2 )
    , ( 1, 2, 3 )
    , ( 1, 8, 5 )
    , ( 4, 5, 7 )
    , ( 2, 3, 8 )
    , ( 2, 1, 5 )
    , ( 4, 7, 6 )
    , ( 6, 4, 7 )
    , ( 4, 9, 8 )
    , ( 14, 6, 7 )
    , ( 8, 1, 7 )
    , ( 7, 1, 3 )
    , ( 3, 5, 9 )
    , ( 28, 7, 5 )
    , ( 1, 1, 8 )
    , ( 4, 8, 3 )
    , ( 9, 3, 1 )
    , ( 1, 9, 5 )
    , ( 6, 3, 2 )
    , ( 10, 1, 6 )
    , ( 1, 1, 9 )
    , ( 5, 9, 7 )
    , ( 14, 5, 3 )
    , ( 1, 4, 1 )
    , ( 1, 7, 2 )
    , ( 1, 7, 1 )
    , ( 1, 1, 7 )
    , ( 3, 8, 5 )
    , ( 4, 6, 3 )
    , ( 3, 7, 2 )
    , ( 15, 3, 6 )
    , ( 16, 5, 7 )
    , ( 4, 2, 8 )
    , ( 1, 3, 1 )
    , ( 5, 7, 3 )
    , ( 12, 6, 4 )
    , ( 4, 8, 5 )
    , ( 1, 4, 2 )
    , ( 2, 5, 3 )
    , ( 8, 6, 3 )
    , ( 7, 4, 5 )
    , ( 9, 7, 6 )
    , ( 1, 7, 9 )
    , ( 1, 1, 9 )
    , ( 1, 1, 9 )
    , ( 5, 2, 8 )
    , ( 5, 8, 2 )
    , ( 11, 5, 9 )
    , ( 1, 4, 2 )
    , ( 4, 9, 6 )
    , ( 12, 3, 7 )
    , ( 3, 4, 9 )
    , ( 14, 6, 2 )
    , ( 2, 2, 4 )
    , ( 2, 3, 5 )
    , ( 10, 7, 2 )
    , ( 1, 4, 8 )
    , ( 1, 2, 7 )
    , ( 28, 2, 9 )
    , ( 4, 7, 5 )
    , ( 1, 2, 4 )
    , ( 6, 5, 1 )
    , ( 2, 4, 3 )
    , ( 1, 8, 1 )
    , ( 40, 9, 1 )
    , ( 10, 1, 6 )
    , ( 5, 3, 5 )
    , ( 1, 9, 8 )
    , ( 3, 6, 7 )
    , ( 11, 1, 2 )
    , ( 9, 2, 3 )
    , ( 3, 5, 1 )
    , ( 4, 7, 1 )
    , ( 2, 2, 4 )
    , ( 2, 5, 8 )
    , ( 19, 1, 7 )
    , ( 8, 3, 2 )
    , ( 14, 1, 8 )
    , ( 14, 7, 1 )
    , ( 4, 6, 5 )
    , ( 1, 1, 9 )
    ]
